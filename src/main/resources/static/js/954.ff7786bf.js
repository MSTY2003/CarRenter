"use strict";(self["webpackChunkcar"]=self["webpackChunkcar"]||[]).push([[954],{954:function(e,t,l){l.r(t),l.d(t,{default:function(){return Q}});var s=l(3396),r=l(9242),a=l(7139);const u=e=>((0,s.dD)("data-v-0880ce1f"),e=e(),(0,s.Cn)(),e),o={key:0,class:"modal"},n={class:"modal-content"},c=u((()=>(0,s._)("label",null,"账号",-1))),d=u((()=>(0,s._)("label",null,"密码",-1))),i=u((()=>(0,s._)("label",null,"用户权限",-1))),h=u((()=>(0,s._)("option",{value:"ADMIN"},"管理员",-1))),m=u((()=>(0,s._)("option",{value:"NORMAL"},"用户",-1))),p=[h,m],_=u((()=>(0,s._)("button",{type:"submit"},"更新",-1))),D={key:1,class:"modal"},I={class:"modal-content"},w=u((()=>(0,s._)("p",null,"你确定要删除这个用户吗？",-1))),y={class:"one"},M=u((()=>(0,s._)("i",{class:"fa fa-search"},null,-1))),k=u((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"序号"),(0,s._)("th",null,"账号"),(0,s._)("th",null,"密码"),(0,s._)("th",null,"用户权限"),(0,s._)("th",null,"操作")])],-1))),b=u((()=>(0,s._)("td",null,[(0,s._)("input",{type:"checkbox"})],-1))),f=["onClick"],v=["onClick"];function g(e,t,l,u,h,m){return(0,s.wg)(),(0,s.iD)("div",null,[h.showModal?((0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",n,[(0,s._)("span",{class:"close",onClick:t[0]||(t[0]=(...e)=>m.closeModal&&m.closeModal(...e))},"×"),(0,s._)("form",{onSubmit:t[4]||(t[4]=(0,r.iM)(((...e)=>m.updateItem&&m.updateItem(...e)),["prevent"]))},[c,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>h.currentItem.userName=e),required:""},null,512),[[r.nr,h.currentItem.userName]]),d,(0,s.wy)((0,s._)("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=e=>h.currentItem.password=e),required:""},null,512),[[r.nr,h.currentItem.password]]),i,(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.currentItem.userType=e),required:""},p,512),[[r.bM,h.currentItem.userType]]),_],32)])])):(0,s.kq)("",!0),h.showDeleteModal?((0,s.wg)(),(0,s.iD)("div",D,[(0,s._)("div",I,[(0,s._)("span",{class:"close",onClick:t[5]||(t[5]=(...e)=>m.closeDeleteModal&&m.closeDeleteModal(...e))},"×"),w,(0,s._)("button",{onClick:t[6]||(t[6]=(...e)=>m.confirmDelete&&m.confirmDelete(...e))},"确认"),(0,s._)("button",{onClick:t[7]||(t[7]=(...e)=>m.closeDeleteModal&&m.closeDeleteModal(...e))},"取消")])])):(0,s.kq)("",!0),(0,s._)("div",y,[(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>h.searchQuery=e),placeholder:"搜索..."},null,512),[[r.nr,h.searchQuery]]),(0,s._)("button",{onClick:t[9]||(t[9]=(...e)=>m.search&&m.search(...e))},[M,(0,s.Uk)("搜索")]),(0,s._)("table",null,[k,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(h.searchResults,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t},[b,(0,s._)("td",null,(0,a.zw)(e.userID),1),(0,s._)("td",null,(0,a.zw)(e.userName),1),(0,s._)("td",null,(0,a.zw)(e.password),1),(0,s._)("td",null,(0,a.zw)("ADMIN"===e.userType?"管理员":"用户"),1),(0,s._)("td",null,[(0,s._)("button",{onClick:l=>m.editItem(t,e.userID)},"编辑",8,f),(0,s._)("button",{onClick:t=>m.deleteItem(e.userID)},"删除",8,v)])])))),128))])])])])}var C=l(1076),U={data(){return{currentItem:{},searchQuery:"",searchResults:[],userList:[],showModal:!1,showDeleteModal:!1,deleteID:null}},created(){this.updateData()},methods:{updateData(){C.Z.get("/car/getAllUsers").then((e=>{this.userList=e.data,this.searchResults=this.userList})).catch((e=>{console.error(e)}))},editItem(e,t){console.log("index"+e+",id:"+t+",item"+this.userList[e]["userID"]),this.currentItem=Object.assign({},this.userList[e]),this.showModal=!0},closeModal(){this.showModal=!1},updateItem(){console.log(this.currentItem.userID);let e=`/car/modifyUser/${this.currentItem.userID}`,t={userName:this.currentItem.userName,password:this.currentItem.password,userType:this.currentItem.userType};C.Z.put(e,t).then((e=>{console.log("更新成功: ",e.data),this.showModal=!1,this.updateData()})).catch((e=>{console.error("更新失败: ",e)}))},deleteItem(e){this.deleteID=e,this.showDeleteModal=!0},closeDeleteModal(){this.showDeleteModal=!1},confirmDelete(){this.deleteUser(this.deleteID),this.showDeleteModal=!1},deleteUser(e){let t=`/car/removeUser/${e}`;C.Z.delete(t).then((e=>{console.log("删除成功: ",e.data),alert("删除成功"),this.updateData()})).catch((e=>{console.error("删除失败: ",e)}))},search(){this.searchQuery?this.searchResults=this.userList.filter((e=>e.userName.includes(this.searchQuery)||e.userID.toString().includes(this.searchQuery)||e.userType.includes(this.searchQuery))):this.searchResults=this.userList}}},N=l(89);const L=(0,N.Z)(U,[["render",g],["__scopeId","data-v-0880ce1f"]]);var Q=L}}]);
//# sourceMappingURL=954.ff7786bf.js.map